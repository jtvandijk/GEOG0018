<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>GEOG0018</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./05-spatial2.html" rel="next">
<link href="./03-statistics2.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>


<link rel="stylesheet" href="assets/styles.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./04-spatial1.html">Spatial Analysis</a></li><li class="breadcrumb-item"><a href="./04-spatial1.html">Spatial Analysis I</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
      <a href="./index.html" class="sidebar-logo-link">
      <img src="./assets/logo.svg" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/jtvandijk/GEOG0018" rel="" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
    <div id="quarto-search" class="quarto-navigation-tool px-1" title="Search"></div>
</div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Module overview</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-installation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Getting Started</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Statistical Analysis</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-recap.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">1 R for Data Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-statistics1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2 Statistical Analysis I</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-statistics2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">3 Statistical Analysis II</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Spatial Analysis</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-spatial1.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">4 Spatial Analysis I</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-spatial2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">5 Spatial Analysis II</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#spatial-analysis-i" id="toc-spatial-analysis-i" class="nav-link active" data-scroll-target="#spatial-analysis-i"><span class="header-section-number">4</span> Spatial Analysis I</a>
  <ul class="collapse">
  <li><a href="#lecture-slides" id="toc-lecture-slides" class="nav-link" data-scroll-target="#lecture-slides"><span class="header-section-number">4.1</span> Lecture slides</a></li>
  <li><a href="#reading-list" id="toc-reading-list" class="nav-link" data-scroll-target="#reading-list"><span class="header-section-number">4.2</span> Reading list</a></li>
  <li><a href="#installation-of-qgis" id="toc-installation-of-qgis" class="nav-link" data-scroll-target="#installation-of-qgis"><span class="header-section-number">4.3</span> Installation of QGIS</a></li>
  <li><a href="#population-in-london" id="toc-population-in-london" class="nav-link" data-scroll-target="#population-in-london"><span class="header-section-number">4.4</span> Population in London</a>
  <ul class="collapse">
  <li><a href="#data-preparation" id="toc-data-preparation" class="nav-link" data-scroll-target="#data-preparation"><span class="header-section-number">4.4.1</span> Data preparation</a></li>
  <li><a href="#data-merging" id="toc-data-merging" class="nav-link" data-scroll-target="#data-merging"><span class="header-section-number">4.4.2</span> Data merging</a></li>
  <li><a href="#data-mapping" id="toc-data-mapping" class="nav-link" data-scroll-target="#data-mapping"><span class="header-section-number">4.4.3</span> Data mapping</a></li>
  </ul></li>
  <li><a href="#homework-task" id="toc-homework-task" class="nav-link" data-scroll-target="#homework-task"><span class="header-section-number">4.5</span> Homework task</a></li>
  <li><a href="#before-you-leave" id="toc-before-you-leave" class="nav-link" data-scroll-target="#before-you-leave"><span class="header-section-number">4.6</span> Before you leave</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/jtvandijk/GEOG0018/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">



<section id="spatial-analysis-i" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">4</span> Spatial Analysis I</h1>
<p>This week’s lecture introduced foundational concepts in GIScience and GIS software, with a focus on how spatial data is represented. Building on these ideas, the practical component allows you to apply this knowledge by creating thematic maps using <a href="https://qgis.org/">QGIS</a>.</p>
<section id="lecture-slides" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="lecture-slides"><span class="header-section-number">4.1</span> Lecture slides</h2>
<p>You can download the slides of this week’s lecture here: <a href="https://github.com/jtvandijk/GEOG0018/raw/master/slides/w09-mhg.pdf">[Link]</a>.</p>
</section>
<section id="reading-list" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="reading-list"><span class="header-section-number">4.2</span> Reading list</h2>
<section id="essential-readings" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="essential-readings">Essential readings</h4>
<ul>
<li>Longley, P. <em>et al.</em> 2015. Geographic Information Science &amp; Systems, <strong>Chapter 2</strong>: <em>The Nature of Geographic Data</em>, pp.&nbsp;33-54. <a href="https://ucl.rl.talis.com/link?url=https%3A%2F%2Fapp.knovel.com%2Fhotlink%2Ftoc%2Fid%3AkpGISSE001%2Fgeographic-information-science%3Fkpromoter%3Dmarc&amp;sig=e437927b963cc591dcb65491eccdd3869cc31aef80e1443cb2ba12d8f3bb031a">[Link]</a></li>
<li>Longley, P. <em>et al.</em> 2015. Geographic Information Science &amp; Systems, <strong>Chapter 3</strong>: <em>Representing Geography</em>, pp.&nbsp;55-76. <a href="https://ucl.rl.talis.com/link?url=https%3A%2F%2Fapp.knovel.com%2Fhotlink%2Ftoc%2Fid%3AkpGISSE001%2Fgeographic-information-science%3Fkpromoter%3Dmarc&amp;sig=e437927b963cc591dcb65491eccdd3869cc31aef80e1443cb2ba12d8f3bb031a">[Link]</a></li>
</ul>
</section>
<section id="suggested-readings" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="suggested-readings">Suggested readings</h4>
<ul>
<li>Yuan, M. 2001. Representing complex geographic phenomena in GIS. <em>Cartography and Geographic Information Science</em> 28(2): 83-96. <a href="https://doi.org/10.1559/152304001782173718">[Link]</a></li>
</ul>
</section>
</section>
<section id="installation-of-qgis" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="installation-of-qgis"><span class="header-section-number">4.3</span> Installation of QGIS</h2>
<p>QGIS is an open-source graphic user interface GIS with many community developed add-on packages that provide additional functionality to the software. You can download and install QGIS on your personal machine by going to the QGIS website: <a href="https://qgis.org/en/site/forusers/download.html">[Link]</a>.</p>
<div class="callout callout-style-simple callout-important">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>QGIS is available through <a href="https://www.ucl.ac.uk/isd/services/computers/remote-access/desktopucl-anywhere">Desktop@UCL Anywhere</a> as well as that it can be accessed on UCL computers across campus. Instead of installing the software, you may want to consider using this version.</p>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>If you want to install QGIS on your personal computer, we recommend installing the <strong>Long Term Release</strong> (<em>QGIS 3.34 LTR</em>), as this version is the most current and stable. For Windows users, please note that the QGIS installation process may take some time, so be patient during the setup.</p>
</div>
</div>
</div>
<p>After installation, launch QGIS to confirm that the installation was successful.</p>
</section>
<section id="population-in-london" class="level2" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="population-in-london"><span class="header-section-number">4.4</span> Population in London</h2>
<p>In this tutorial, we will map the population distribution in London using Census estimates from 2011 and 2021. When working with quantitative data, much of the effort goes into data preparation rather than analysis. It is often said that 80% of the time is spent on tasks like finding, retrieving, managing, and processing data. This is because the data you need is rarely in the format required for analysis. Before we can create our maps, we therefore have to go through several data preparation and cleaning steps.</p>
<p>To get started, download a copy of the 2011 and 2021 London LSOAs spatial boundaries via the links provided below. Save these files in your project folder under <code>data</code>.</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: left;">File</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Link</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">London LSOA 2011 Spatial Boundaries</td>
<td style="text-align: left;"><code>GeoPackage</code></td>
<td style="text-align: left;"><a href="https://github.com/jtvandijk/GEOG0018/raw/master/data/London-LSOA-2011.gpkg">Download</a></td>
</tr>
<tr class="even">
<td style="text-align: left;">London LSOA 2021 Spatial Boundaries</td>
<td style="text-align: left;"><code>GeoPackage</code></td>
<td style="text-align: left;"><a href="https://github.com/jtvandijk/GEOG0018/raw/master/data/London-LSOA-2021.gpkg">Download</a></td>
</tr>
</tbody>
</table>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>Administrative geographies, such as LSOAs, are typically updated as populations change, meaning their boundaries are subject to periodic or occasional adjustments. For this reason, we must use the 2011 LSOA boundaries to map the 2011 Census data and the 2021 LSOA boundaries for the 2021 Census data.</p>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>For the spatial boundaries of the London LSOAs, you may have noticed that, instead of providing a collection of files known as a <code>shapefile</code>, we have supplied a <code>GeoPackage</code>. While <code>shapefiles</code> remain in use, <code>GeoPackage</code> is a more modern and portable file format. Have a look at this article on <em>towardsdatascience.com</em> for an excellent explanation on why one should use <code>GeoPackage</code> files over <code>shapefiles</code>, where possible: <a href="https://towardsdatascience.com/why-you-need-to-use-geopackage-files-instead-of-shapefile-or-geojson-7cb24fe56416">[Link]</a></p>
</div>
</div>
</div>
<p>For our population data, we will use the 2011 and 2021 Census population counts that are made available by the Office for National Statistics through their <a href="https://www.nomisweb.co.uk/">Nomis</a> portal.</p>
<p>To get the 2011 Census population counts, you should:</p>
<ol type="1">
<li>Navigate to the <em>Nomis</em> portal: <a href="https://www.nomisweb.co.uk/">[Link]</a></li>
<li>Click on <strong>Query data</strong> in the <strong>Data Downloads</strong> panel.</li>
<li>Click on <strong>Census 2011</strong> -&gt; <strong>Key Statistics</strong>.</li>
<li>Click on <strong>KS101EW - Usual resident population</strong>.</li>
<li>Select <strong>Geography</strong> and set <strong>2011 super output areas - lower layer</strong> to <strong>All</strong>.</li>
<li>Click on <strong>Download data</strong> at the left hand side of the screen.</li>
<li>Once the data is ready for download, save it to your computer in your <code>data</code> folder as <code>LSOA2011-population.xlsx</code>.</li>
</ol>
<p>To get the 2021 Census population counts, you should:</p>
<ol type="1">
<li>Navigate to the <em>Nomis</em> portal: <a href="https://www.nomisweb.co.uk/">[Link]</a></li>
<li>Click on <strong>Query data</strong> in the <strong>Data Downloads</strong> panel.</li>
<li>Click on <strong>Census 2021</strong> -&gt; <strong>Topic Summaries</strong>.</li>
<li>Click on <strong>TS007A - Age by five-year age bands</strong>.</li>
<li>Select <strong>Geography</strong> and set <strong>2021 super output areas - lower layer</strong> to <strong>All</strong>.</li>
<li>Click on <strong>Download data</strong> at the left hand side of the screen.</li>
<li>Once the data is ready for download, save it to your computer in your <code>data</code> folder as <code>LSOA2021-population.xlsx</code>.</li>
</ol>
<section id="data-preparation" class="level3" data-number="1.4.1">
<h3 data-number="1.4.1" class="anchored" data-anchor-id="data-preparation"><span class="header-section-number">4.4.1</span> Data preparation</h3>
<p>When opening the LSOA spreadsheets in Excel, you will notice additional rows of information at the top. This extra data can cause issues in QGIS, so we need to clean the dataset. To avoid errors later on, we will also save the cleaned data in <code>csv</code> format.</p>
<section id="london-population-in-2011" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="london-population-in-2011">London population in 2011</h4>
<p>Open the <code>LSOA2011-population.xlsx</code> file in Excel. We have two main columns: one with identifying information that distinguishes each area from one another and one with population counts. In addition, there are some less informative rows at the top of the spreadsheet. To prepare the data we need to take several steps.</p>
<ol type="1">
<li>Open a new, empty Excel spreadsheet.</li>
<li>From the <code>LSOA2011-population.xlsx</code> spreadsheet, select and delete row <strong>1 to 8</strong>: highlight the rows, then click on <strong>Edit</strong> in the menu bar and click on <strong>Delete</strong>.</li>
</ol>
<div class="callout callout-style-simple callout-warning">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>Note that the <strong>Edit</strong> menu bar option might be named differently, depending your version of Excel and/or your operating system.</p>
</div>
</div>
</div>
<ol start="3" type="1">
<li>Rename the columns in your spreadsheet to <code>lsoa</code> and <code>pop2011</code>, respectively.</li>
<li>Cut all the data from the <code>pop2011</code> column that is stored in column <strong>B</strong> and paste these into column <strong>C</strong>. You now should have a column <em>without</em> any data sat between the <code>lsoa</code> and <code>pop2011</code> columns.</li>
<li>Highlight the entire <code>lsoa</code> column and in the <strong>Data</strong> menu click on the <strong>Text to Columns</strong> menu button.</li>
</ol>
<div class="cell" data-hash="04-spatial1_cache/html/fig-text-to-columns_d46894c526c2d96186006682d34cae16">
<div class="cell-output-display">
<div id="fig-text-to-columns" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/w09/text-to-columns.png" class="img-fluid figure-img" width="1552"></p>
<figcaption class="figure-caption">Figure&nbsp;1: Highlight the <code>lsoa</code> columns and find the <strong>Text to Columns</strong> menu option. Note that column <strong>B</strong> does not contain any data.</figcaption>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-warning">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>Note that the <strong>Text to Columns</strong> function might be elsewhere in the menu depending on your version of Excel and/or your operating system.</p>
</div>
</div>
</div>
<ol start="6" type="1">
<li>In the <strong>Text to Columns</strong> menu, select the <strong>Delimited</strong> radio button and click <strong>Next</strong>.</li>
<li>Uncheck the checkbox for <strong>Tab</strong> and put <code>:</code> (colon) into the <strong>Other</strong> box. Click <strong>Finish</strong>.</li>
<li>Change the name of the <code>lsoa</code> column to <code>lsoa11_code</code> and change the name of the now populated column <strong>B</strong> to <code>lsoa11_name</code>.</li>
</ol>
<div class="cell" data-hash="04-spatial1_cache/html/fig-almost-there_866e30f7556dac02c68b2ded58cf8ff6">
<div class="cell-output-display">
<div id="fig-almost-there" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/w09/almost-there.png" class="img-fluid figure-img" width="1552"></p>
<figcaption class="figure-caption">Figure&nbsp;2: Your spreadsheet should now look something like this.</figcaption>
</figure>
</div>
</div>
</div>
<ol start="9" type="1">
<li>Select all three columns, click on <strong>Data</strong> in the menu bar and. select <strong>Sort</strong>. In the window that opens, select <code>lsoa11_name</code> as column to sort your data on. Click <strong>OK</strong>.</li>
<li>Now we need to identify the LSOAs pertaining to London. Unfortunately, we can only do this manually by searching for the name of each of the London Boroughs and subsequently cutting (<strong>Edit</strong> -&gt; <strong>Cut</strong>) the associated rows of data from the spreadsheet and pasting these into the second, empty spreadsheet that you created in <em>Step 1</em>.</li>
<li>Go to <strong>Edit</strong> -&gt; <strong>Find</strong> -&gt; <strong>Find</strong>. Type in <strong>City of London</strong>. Cut (<strong>Edit</strong> -&gt; <strong>Cut</strong>) the six rows of data (<em>City of London 001A</em>, <em>City of London 001B</em>, etc.) and paste these into the second, empty spreadsheet. Make sure to give your columns appropriate names.</li>
<li>Repeat this process to find all London LSOAs by searching for the names of all remaining <strong>32</strong> London Boroughs (see <a href="#tbl-boroughs">Table&nbsp;1</a> for a list).</li>
</ol>
<div class="callout callout-style-simple callout-tip">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>You can make this process a bit less tedious by using keyboard shortcuts. On MacOS you can use: <code>cmd + f</code> to open up the find menu, <code>cmd + x</code> to cut data, and <code>cmd + v</code> to paste data. On Windows you can use: <code>ctrl + f</code> to open up the find menu, <code>ctrl + x</code> to cut data, and <code>ctrl + v</code> to paste date.</p>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-warning">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>Once you are done cutting and pasting, you should have <strong>4,836</strong> rows of data in your second spreadsheet; this count includes your column names.</p>
</div>
</div>
</div>
<div id="tbl-boroughs" class="anchored">
<table class="table">
<caption>Table&nbsp;1: The names of all London Boroughs.</caption>
<thead>
<tr class="header">
<th style="text-align: left;">London Boroughs</th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Westminster</td>
<td style="text-align: left;">Sutton</td>
</tr>
<tr class="even">
<td style="text-align: left;">Kensington and Chelsea</td>
<td style="text-align: left;">Crodyon</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Hammersmith and Fulham</td>
<td style="text-align: left;">Bromley</td>
</tr>
<tr class="even">
<td style="text-align: left;">Wandsworth</td>
<td style="text-align: left;">Lewisham</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Lambeth</td>
<td style="text-align: left;">Greenwich</td>
</tr>
<tr class="even">
<td style="text-align: left;">Southwark</td>
<td style="text-align: left;">Bexley</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Tower Hamlets</td>
<td style="text-align: left;">Havering</td>
</tr>
<tr class="even">
<td style="text-align: left;">Hackney</td>
<td style="text-align: left;">Barking and Dagenham</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Islington</td>
<td style="text-align: left;">Redbridge</td>
</tr>
<tr class="even">
<td style="text-align: left;">Camden</td>
<td style="text-align: left;">Newham</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Brent</td>
<td style="text-align: left;">Waltham Forest</td>
</tr>
<tr class="even">
<td style="text-align: left;">Ealing</td>
<td style="text-align: left;">Haringey</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Hounslow</td>
<td style="text-align: left;">Enfield</td>
</tr>
<tr class="even">
<td style="text-align: left;">Richmond upon Thames</td>
<td style="text-align: left;">Barnet</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Kingston upon Thames</td>
<td style="text-align: left;">Harrow</td>
</tr>
<tr class="even">
<td style="text-align: left;">Merton</td>
<td style="text-align: left;">Hillingdon</td>
</tr>
</tbody>
</table>
</div>
<ol start="13" type="1">
<li>One potential issue when linking the population data to the spatial data is the presence of <a href="(https://stackoverflow.com/questions/22273233/what-is-meant-by-trailing-space-and-whats-the-difference-between-it-and-a-blank)">trailing spaces</a> in the <code>lsoa11_code</code> column. These spaces are not immediately noticeable, as they appear at the end of the LSOA codes without any visible characters following them. Although this may seem minor, it can cause problems when using the data. To fix this, highlight the entire <code>lsoa11_code</code> column in your new spreadsheet, go to the <strong>Home</strong> menu, and select <strong>Replace</strong> under the <strong>Find &amp; Select</strong> menu.</li>
</ol>
<div class="cell" data-hash="04-spatial1_cache/html/fig-find-replace_1bfdd665d5972e24bdef5ebb675de0db">
<div class="cell-output-display">
<div id="fig-find-replace" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/w09/find-replace.png" class="img-fluid figure-img" width="1552"></p>
<figcaption class="figure-caption">Figure&nbsp;3: Accessing the <strong>Replace</strong> option.</figcaption>
</figure>
</div>
</div>
</div>
<ol start="14" type="1">
<li>In the <strong>Find what</strong> box put in a singular <code>whitespace</code>, using the <em>spacebar</em> on your keyboard, keep the <strong>Replace with</strong> box empty, and click on <strong>Replace all</strong>. You should get a message that <strong>4,835</strong> replacements have been made.</li>
</ol>
<p>Before saving your data, one final bit of formatting is needed for the population field. Currently, commas are used to separate the thousands in the values. If we leave these commas, QGIS will interpret them as decimal points, resulting in incorrect population figures.</p>
<ol start="15" type="1">
<li>To format the <code>pop2011</code> column, highlight the entire column and <em>right-click</em> on the <code>C</code> cell. Click on <strong>Format Cells</strong> and set the cells to <strong>Number</strong> with <strong>0</strong> decimal places. You should see that the commas are now removed from your population values.</li>
<li>Save your spreadsheet as a <code>csv</code> file into your <code>data</code> folder as <code>LSOA2011-population.csv</code>.</li>
</ol>
<div class="callout callout-style-simple callout-tip">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>After saving the file, Excel may prompt a warning about possible data loss. You can safely ignore this message, as it typically relates to lost markup information (e.g.&nbsp;fonts, colours, bold items) or Excel formulas (e.g.&nbsp;means, medians). If prompted, choose to save as <code>CSV UTF-8 (Comma-delimited) (.csv)</code>.</p>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-warning">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>Be aware that depending on your operating system’s language settings (e.g.&nbsp;Windows, macOS, Linux), <code>csv</code> files might use different characters instead of commas. While this may seem trivial, it can lead to issues when importing data into another program. Therefore, it is wise to check your <code>csv</code> file in a plain text editor (e.g.&nbsp;<strong>TextEdit</strong> on macOS or <strong>Notepad</strong> on Windows). If you see semicolons (<code>;</code>) instead of commas (<code>,</code>), you can quickly fix this by finding and replacing every semicolon with a comma, just as we did with the <code>whitespace</code> characters in Excel.</p>
</div>
</div>
</div>
</section>
<section id="london-population-in-2021" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="london-population-in-2021">London population in 2021</h4>
<p>Now the 2011 data is prepared, we can move on to the 2021 data. Open the <code>LSOA2021-population.xlsx</code> in Excel. You will notice that the file is formatted largely the same as the <code>LSOA2011-population.xlsx</code> file. However, this time the data for all Local Authority Districts are grouped together, with all data also grouped by region. This arrangement simplifies our task, as we can easily cut the data for each of the 32 Boroughs and the <em>City of London</em> in one go.</p>
<ol type="1">
<li>Open a new Excel spreadsheet.</li>
<li>From the <code>LSOA2021-population.xlsx</code> spreadsheet, cut (<strong>Edit</strong> -&gt; <strong>Cut</strong>) all cells from columns <strong>A to B</strong> and rows <strong>19,790 to 24,783</strong> and paste these into this new spreadsheet.</li>
<li>Take the remaining steps to prepare the 2021 population steps: split the <code>lsoa</code> column, remove the trailing <code>whitespace</code> characters from the LSOA code column, and remove the decimal commas in the population count column.</li>
<li>Save the file as <code>csv</code> into your <code>data</code> folder as <code>LSOA2021-population.csv</code> with the following column names: <code>lsoa21_code</code>, <code>lsoa21_name</code>, and <code>pop2021</code>.</li>
</ol>
<div class="callout callout-style-simple callout-warning">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>Again make sure you did not miss any LSOAs. You should end up with <strong>4,995</strong> rows of data in this second spreadsheet.</p>
</div>
</div>
</div>
</section>
</section>
<section id="data-merging" class="level3" data-number="1.4.2">
<h3 data-number="1.4.2" class="anchored" data-anchor-id="data-merging"><span class="header-section-number">4.4.2</span> Data merging</h3>
<p>We will now use QGIS to map our prepared population data. To achieve this, we first need to join our table data to our spatial datasets.</p>
<ol type="1">
<li>Start <strong>QGIS</strong>.</li>
<li>Click on <strong>Project</strong> -&gt; <strong>New</strong>. Save your project as <code>w09-population-analysis</code>. Remember to save your work throughout the practical.</li>
<li>Before we add our data, we will first set the Coordinate Reference System (CRS) of our Project. Click on <strong>Project</strong> -&gt; <strong>Properties – CRS</strong>. In the Filter box, type <strong>British National Grid</strong>. Select <strong>OSGB 1936 / British National Grid - EPSG:27700</strong> and click <strong>Apply</strong>. Click <strong>OK</strong>.</li>
</ol>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>A CRS is a framework that defines how spatial data is represented in relation to the Earth’s surface. It includes both a coordinate system (which specifies how points in space are represented using numbers) and a set of parameters that define the relationship between those coordinates and actual locations on the Earth.</p>
</div>
</div>
</div>
<p>Now the project is set up, we can start by loading our 2011 spatial layer.</p>
<ol start="4" type="1">
<li>Click on <strong>Layer</strong> -&gt; <strong>Add Layer</strong> -&gt; <strong>Add Vector Layer</strong>.</li>
<li>With <strong>File</strong> as your source type, click on the small three dots button and navigate to your <code>data</code></li>
<li>Highlight the <code>London-LSOA2011.gpkg</code> file and click <strong>Open</strong>. Then click <strong>Add</strong>. You may need to close the box after adding the layer.</li>
</ol>
<p>Next, we will load our 2011 population <code>csv</code>.</p>
<ol start="7" type="1">
<li>Click on <strong>Layer</strong> -&gt; <strong>Add Layer</strong> -&gt; <strong>Add Delimited Text Layer</strong>.</li>
<li>Click on the three dots button again and navigate to the <code>London-LSOA-2011.csv</code> file in your <code>data</code> folder. Your file format should be set to <code>csv</code>. You should further have the following boxes ticked under the <strong>Record and Field options</strong> menu: <code>Decimal separator is comma</code>, <code>First record has field names</code>, <code>Detect field types</code> and <code>Discard empty fields</code>.</li>
<li>Set the Geometry to <em>No geometry (attribute only table)</em> under the <strong>Geometry Definition</strong> menu. Then click <strong>Add</strong> and <strong>Close</strong>. You should now see a table added to your <em>Layers</em> pane.</li>
</ol>
<div class="cell" data-hash="04-spatial1_cache/html/fig-lsoa-london_635b17afc7651a601c96e1d3dca07d64">
<div class="cell-output-display">
<div id="fig-lsoa-london" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/w09/all-lsoa-london.png" class="img-fluid figure-img" width="1552"></p>
<figcaption class="figure-caption">Figure&nbsp;4: The 2011 London LSOAs.</figcaption>
</figure>
</div>
</div>
</div>
<p>We can now join this table data to our spatial data using an <em>attribute join</em>.</p>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>An <em>atribute join</em> allows you to link two datasets together based on a common attribute that facilitates the matching of rows. To perform an attribute join, you need a single unique identifying field for your records in both datasets. This can be a code, a name, or any other string of information. For the join to work, it is essential that the ID field is consistent across both datasets, meaning there should be no typos or spelling mistakes.</p>
<div class="cell" data-hash="04-spatial1_cache/html/fig-join-those-attributes_0f84fb65c7c2451425886202dd0d5f7c">
<div class="cell-output-display">
<div id="fig-join-those-attributes" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/w09/attribute-joins.png" class="img-fluid figure-img" width="435"></p>
<figcaption class="figure-caption">Figure&nbsp;5: Attribute Joins.</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<p>Because both our datasets contain both LSOA names and LSOA codes, we will use the LSOA codes as basis for our join. Unlike names, codes reduce the likelihood of errors and mismatches since they are not dependent on spelling.</p>
<ol start="10" type="1">
<li>Open up the <strong>Attribute Tables</strong> of each layer to confirm the columnnames that we can use for the join.</li>
<li><em>Right-click</em> on your <code>LSOA2011</code> spatial layer, click on <strong>Properties</strong> and then click on the <strong>Joins</strong> tab.
<ul>
<li>Click on the <strong>+</strong> button. Make sure the <strong>Join Layer</strong> is set to <code>LSOA2011-population</code>.</li>
<li>Set the <strong>Join field</strong> to <code>lsoa11_code</code>.</li>
<li>Set the <strong>Target field</strong> to <code>lsoa11cd</code>.</li>
<li>Click the <strong>Joined Fields</strong> box and click to only select the <code>pop2011</code> field.</li>
<li>Click on the <strong>Custom Field Name Prefix</strong> and <strong>remove</strong> the pre-entered text to leave it blank.</li>
<li>Click on <strong>OK</strong>.</li>
<li>Click on <strong>Apply</strong> in the main Join tab and then click <strong>OK</strong> to return to the main QGIS window.</li>
</ul></li>
</ol>
<p>We can now check to see if our join has worked by opening up the <strong>Attribute Table</strong> of our <code>LSOA2011</code> spatial layer. We should see that the spatial layer has a new <strong>Population</strong> field attached to it.</p>
</section>
<section id="data-mapping" class="level3" data-number="1.4.3">
<h3 data-number="1.4.3" class="anchored" data-anchor-id="data-mapping"><span class="header-section-number">4.4.3</span> Data mapping</h3>
<p>We can now finally map the 2011 population distribution of London.</p>
<ol start="12" type="1">
<li><em>Right-click</em> on the <code>London-LSOA-2011</code> layer and click on <strong>Properties</strong> -&gt; <strong>Symbology</strong>.
<ul>
<li>In the dropdown menu at the top of the window, select <strong>Graduated</strong> as symbology.</li>
<li>Under <strong>Value</strong> choose <code>pop2011</code> as your column.</li>
<li>We can then change the color ramp to suit our aesthetic preferences. In the <strong>Colour ramp</strong> dropdown menu select <em>Magma</em>.</li>
<li>The final step is to classify our data, which involves deciding how to group the values in our dataset to create a graduated representation. Today we will use the <strong>Natural Breaks</strong> option. Open the drop-down menu next to <strong>Mode</strong>, select <strong>Natural Breaks</strong>, change it to <strong>7</strong> classes and then click <strong>Classify</strong>.</li>
<li>Finally click <strong>Apply</strong> to style your dataset.</li>
</ul></li>
</ol>
<p>You should now be looking at something like this:</p>
<div class="cell" data-hash="04-spatial1_cache/html/fig-lsoa-pop-2011_aa6b2ed056faa5a4a40d50771cd47633">
<div class="cell-output-display">
<div id="fig-lsoa-pop-2011" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/w09/lsoa-population-2011.png" class="img-fluid figure-img" width="1552"></p>
<figcaption class="figure-caption">Figure&nbsp;6: The population distribution of London in 2011.</figcaption>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-warning">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>While the map above is acceptable for today, it is technically incorrect because it displays absolute numbers on a choropleth. You should never do this unless the spatial units are identical in size, as larger areas will draw disproportionate attention and skew the visualisation.</p>
</div>
</div>
</div>
<p>To export your map to an image, click on <strong>Project</strong> -&gt; <strong>Import/Export</strong> -&gt; <strong>Export to Image</strong>.</p>
</section>
</section>
<section id="homework-task" class="level2" data-number="1.5">
<h2 data-number="1.5" class="anchored" data-anchor-id="homework-task"><span class="header-section-number">4.5</span> Homework task</h2>
<p>This concludes this week’s tutorial. Now complete the following homework tasks:</p>
<ol type="1">
<li>Load the <code>London-LSOA2021.gpkg</code> into QGIS.</li>
<li>Load the <code>LSOA2021-population.csv</code> into QGIS.</li>
<li>Join the two datasets together using an <strong>Attribute Join</strong>.</li>
<li>Style your data appropriately.</li>
<li>Export your map as an image.</li>
</ol>
<div class="callout callout-style-simple callout-warning">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>Paste the exported map into the appendix of your assignment, include a few sentences interpreting the results. Consider whether there are any noticeable changes in the population distribution between 2011 and 2021.</p>
</div>
</div>
</div>
</section>
<section id="before-you-leave" class="level2" data-number="1.6">
<h2 data-number="1.6" class="anchored" data-anchor-id="before-you-leave"><span class="header-section-number">4.6</span> Before you leave</h2>
<p>This week we spent a lot of time preparing and cleaning our datasets, followed by a simple visualisation of the population in London in 2011 and 2021. Next week, we will move forward with working in QGIS and conduct some point data aggregation. For today, however, <a href="https://www.youtube.com/watch?v=Wmc8bQoL-J0">we are done</a>!</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./03-statistics2.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Statistical Analysis II</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./05-spatial2.html" class="pagination-link">
        <span class="nav-page-text">Spatial Analysis II</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">Course material by <a href="https://www.mappingdutchman.com">Justin van Dijk</a>. Available under <a href="https://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a>.</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>



<script src="site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>